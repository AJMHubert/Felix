<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Felix: /home/jacob/a/Felix/src/felixrefine.f90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Felix
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('felixrefine_8f90.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">felixrefine.f90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aecbf263fc9c06070ed63b7a31c76bbef"><td class="memItemLeft" align="right" valign="top">program&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="felixrefine_8f90.html#aecbf263fc9c06070ed63b7a31c76bbef">felixrefine</a></td></tr>
<tr class="memdesc:aecbf263fc9c06070ed63b7a31c76bbef"><td class="mdescLeft">&#160;</td><td class="mdescRight">felixrefine  <a href="#aecbf263fc9c06070ed63b7a31c76bbef">More...</a><br /></td></tr>
<tr class="separator:aecbf263fc9c06070ed63b7a31c76bbef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8e060ee643c1d20de6db468a168e3a1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="felixrefine_8f90.html#ad8e060ee643c1d20de6db468a168e3a1">assignarraylocationstoiterationvariables</a> (IIterativeVariableType, IVariableNo, IArrayToFill, IErr)</td></tr>
<tr class="memdesc:ad8e060ee643c1d20de6db468a168e3a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure-description: Assign array locations to iteration variables, similar to IIterativeVariableUniqueIDs.  <a href="#ad8e060ee643c1d20de6db468a168e3a1">More...</a><br /></td></tr>
<tr class="separator:ad8e060ee643c1d20de6db468a168e3a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1958943a62f02d0f6aa287fedf1f204"><td class="memItemLeft" align="right" valign="top">real(rkind) function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="felixrefine_8f90.html#ae1958943a62f02d0f6aa287fedf1f204">randomnumber</a> (IRequestedNumber, IErr)</td></tr>
<tr class="memdesc:ae1958943a62f02d0f6aa287fedf1f204"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure-description: Sets up a pseudo random sequence and selects a number.  <a href="#ae1958943a62f02d0f6aa287fedf1f204">More...</a><br /></td></tr>
<tr class="separator:ae1958943a62f02d0f6aa287fedf1f204"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8885a59d6f16b8d1febf5f7322f052fc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="felixrefine_8f90.html#a8885a59d6f16b8d1febf5f7322f052fc">outofunitcellcheck</a> (IVariableID, RProposedMovement, RCorrectedMovement, IErr)</td></tr>
<tr class="memdesc:a8885a59d6f16b8d1febf5f7322f052fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure-description: Checks that vector movement applied by the simplex initialisation does not move an atom out fo the unit cell, and if it does the atom is moved back into the unit cell on the opposite side as if the atom had moved from one unit cell into the neighbouring one.  <a href="#a8885a59d6f16b8d1febf5f7322f052fc">More...</a><br /></td></tr>
<tr class="separator:a8885a59d6f16b8d1febf5f7322f052fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4efcf826a274c8692db15b4011b7a1a1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="felixrefine_8f90.html#a4efcf826a274c8692db15b4011b7a1a1">setupatomicvectormovements</a> (IErr)</td></tr>
<tr class="memdesc:a4efcf826a274c8692db15b4011b7a1a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure-description: Setup atomic vector movements.  <a href="#a4efcf826a274c8692db15b4011b7a1a1">More...</a><br /></td></tr>
<tr class="separator:a4efcf826a274c8692db15b4011b7a1a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5f6bb0d2c9f43343ba26449a1d92f7e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="felixrefine_8f90.html#ad5f6bb0d2c9f43343ba26449a1d92f7e">bestfitcheck</a> (RFoM, RBest, RCurrent, RIndependentVariable, IErr)</td></tr>
<tr class="memdesc:ad5f6bb0d2c9f43343ba26449a1d92f7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Procedure-description: Best fit check.  <a href="#ad5f6bb0d2c9f43343ba26449a1d92f7e">More...</a><br /></td></tr>
<tr class="separator:ad5f6bb0d2c9f43343ba26449a1d92f7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="ad8e060ee643c1d20de6db468a168e3a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine assignarraylocationstoiterationvariables </td>
          <td>(</td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IIterativeVariableType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IVariableNo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ikind), dimension(inoofvariables,5), intent(out)&#160;</td>
          <td class="paramname"><em>IArrayToFill</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Procedure-description: Assign array locations to iteration variables, similar to IIterativeVariableUniqueIDs. </p>
<p>Major-Authors: Keith Evans (2014), Richard Beanland (2016) </p>

</div>
</div>
<a class="anchor" id="ad5f6bb0d2c9f43343ba26449a1d92f7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine bestfitcheck </td>
          <td>(</td>
          <td class="paramtype">real(rkind)&#160;</td>
          <td class="paramname"><em>RFoM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(rkind)&#160;</td>
          <td class="paramname"><em>RBest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(rkind), dimension(inoofvariables)&#160;</td>
          <td class="paramname"><em>RCurrent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(rkind), dimension(inoofvariables)&#160;</td>
          <td class="paramname"><em>RIndependentVariable</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Procedure-description: Best fit check. </p>
<p>Major-Authors: Richard Beanland (2016) </p>

</div>
</div>
<a class="anchor" id="aecbf263fc9c06070ed63b7a31c76bbef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">program felixrefine </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>felixrefine </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="felixrefine_8f90_aecbf263fc9c06070ed63b7a31c76bbef_cgraph.png" border="0" usemap="#felixrefine_8f90_aecbf263fc9c06070ed63b7a31c76bbef_cgraph" alt=""/></div>
<map name="felixrefine_8f90_aecbf263fc9c06070ed63b7a31c76bbef_cgraph" id="felixrefine_8f90_aecbf263fc9c06070ed63b7a31c76bbef_cgraph">
<area shape="rect" id="node2" href="namespacemynumbers.html#a6c534f4b86169a7c5d8d3296e270c3f0" title="mynumbers::init_numbers" alt="" coords="171,32,343,59"/>
<area shape="rect" id="node3" href="namespacemessage__mod.html#a78e3db6e34ae64bc8b9d5fe3917c3cc2" title="message_mod::init_message\l_logicals" alt="" coords="161,83,353,125"/>
<area shape="rect" id="node4" href="in_8f90.html#ad682220f9636994bc58dcbc1969014b3" title="Procedure&#45;description: " alt="" coords="217,149,298,176"/>
<area shape="rect" id="node8" href="namespacemessage__mod.html#a89980d02f28fcddf3406735209e4663c" title="message_mod::set_message\l_logicals" alt="" coords="161,269,354,310"/>
<area shape="rect" id="node9" href="readcif_8f90.html#a851b318f1c18608adf2b40ba20d10014" title="Procedure&#45;description: Reads from felix.cif input file using toolbox. " alt="" coords="227,335,288,361"/>
<area shape="rect" id="node18" href="in_8f90.html#a9ae69453876c52f4da36cd8caa77b4d9" title="Procedure&#45;description: " alt="" coords="217,385,298,412"/>
<area shape="rect" id="node19" href="in_8f90.html#a87a95b2c1cc473f5470120055efa930f" title="Procedure&#45;description: " alt="" coords="176,436,339,463"/>
<area shape="rect" id="node20" href="scatteringfactors_8f90.html#a5cd7b8a4849c208eafee03ef0e3f6783" title="Procedure&#45;description: Contains all of the scattering coefficients for each of the following methods:..." alt="" coords="198,487,317,513"/>
<area shape="rect" id="node21" href="crystallography_8f90.html#a0860d82af13316c7aad5ad449d073490" title="Procedure&#45;description: Creates reciprocal lattice vectors in Microscope reference frame..." alt="" coords="201,537,314,564"/>
<area shape="rect" id="node23" href="crystallography_8f90.html#a118dc8a18775a4efb509337c9c612dc2" title="Procedure&#45;description: Calculates the FULL set of possible fractional atomic positions and then gets ..." alt="" coords="751,791,892,817"/>
<area shape="rect" id="node24" href="diffractionpatterndefinitions_8f90.html#ace160696341b9c3e69d18d5b32075251" title="Procedure&#45;description: Counts the number of reflections limited by Ihklmax and the acceptance angle..." alt="" coords="222,639,293,665"/>
<area shape="rect" id="node25" href="diffractionpatterndefinitions_8f90.html#a6f8038a3f0f6760ee59abf2e90ba1467" title="Procedure&#45;description: Fills the list of reciprocal space vectors Rhkl. " alt="" coords="222,689,293,716"/>
<area shape="rect" id="node26" href="util_8f90.html#a21a38bcc223902d8d5561c28c4c3f092" title="Procedure&#45;description: Sorts array into descending order. " alt="" coords="227,740,288,767"/>
<area shape="rect" id="node27" href="diffractionpatterndefinitions_8f90.html#a3ccb3f5891d41b40d928f04dc888d844" title="Procedure&#45;description: Assign numbers to the different reflections in IOutputReflections. " alt="" coords="158,791,357,817"/>
<area shape="rect" id="node28" href="Ug_8f90.html#a160aa58e5d944ecd528d77915bbae4b3" title="Procedure&#45;description: " alt="" coords="170,588,345,615"/>
<area shape="rect" id="node32" href="Ug_8f90.html#a5637638595593ffb09280db93d99adc1" title="Procedure&#45;description: Select case using IAbsorbFLAG. " alt="" coords="780,841,863,868"/>
<area shape="rect" id="node34" href="felixrefine_8f90.html#a4efcf826a274c8692db15b4011b7a1a1" title="Procedure&#45;description: Setup atomic vector movements. " alt="" coords="159,943,356,969"/>
<area shape="rect" id="node38" href="felixrefine_8f90.html#ad8e060ee643c1d20de6db468a168e3a1" title="Procedure&#45;description: Assign array locations to iteration variables, similar to IIterativeVariableUn..." alt="" coords="132,993,383,1020"/>
<area shape="rect" id="node39" href="image_8f90.html#a0b509b7e83cc03d72bb5b850c227799c" title="Procedure&#45;description: Image setup, including defining image masks. " alt="" coords="213,1044,302,1071"/>
<area shape="rect" id="node42" href="felixfunction_8f90.html#ae83fd801e24c7b920e1cf0ef9e358185" title="Procedure&#45;description: Felixfunction. " alt="" coords="775,1171,867,1197"/>
<area shape="rect" id="node45" href="RefineWriteOut_8f90.html#a892a322c60916ccd590ce29c18491b2c" title="Procedure&#45;description: " alt="" coords="755,1235,887,1261"/>
<area shape="rect" id="node46" href="felixfunction_8f90.html#a121661ef25e3c87dd4ba59c48cc7ca87" title="Procedure&#45;description: Calculate figure of merit and determine Thickness, involving image processing ..." alt="" coords="681,1285,961,1312"/>
<area shape="rect" id="node47" href="felixfunction_8f90.html#adcb9fd1a6de6119cd7591814585634cd" title="Procedure&#45;description: Simulate and fit. " alt="" coords="481,1196,583,1223"/>
<area shape="rect" id="node48" href="simplex_8f90.html#a51042de79e202f5b883de0d70b0815dc" title="Procedure&#45;description: " alt="" coords="162,1196,353,1223"/>
<area shape="rect" id="node49" href="felixrefine_8f90.html#ad5f6bb0d2c9f43343ba26449a1d92f7e" title="Procedure&#45;description: Best fit check. " alt="" coords="211,1348,304,1375"/>
<area shape="rect" id="node50" href="felixfunction_8f90.html#abc51414259f4231e51dee9b93f3a4300" title="Procedure&#45;description: Input is a vector Rx with three x&#45;coordinates and Ry with three y&#45;coordinates..." alt="" coords="223,1399,291,1425"/>
<area shape="rect" id="node5" href="in_8f90.html#a36aea91398203926e4b90bbd77a2450c" title="Procedure&#45;description: Function that reads in a 3D vector from a file, which has to have the form [I1..." alt="" coords="461,107,603,133"/>
<area shape="rect" id="node6" href="in_8f90.html#a5fe3176d3afaf8aacbb5daa5bf996c18" title="Procedure&#45;description: " alt="" coords="431,5,633,32"/>
<area shape="rect" id="node7" href="in_8f90.html#a9efc400b2c2433e8f89c9e92f2650a16" title="Procedure&#45;description: Write out the sample input file, when none provided. " alt="" coords="475,56,589,83"/>
<area shape="rect" id="node10" href="ciftbx_8f.html#a3ae51c94c9f58e02a2d56413d8e1ed4c" title="init_" alt="" coords="509,157,555,184"/>
<area shape="rect" id="node11" href="ciftbx_8f.html#a4b968cff97c84029fcb089e5754373eb" title="dict_" alt="" coords="507,208,557,235"/>
<area shape="rect" id="node12" href="ciftbx-wrapper_8f90.html#ae5a0dc77713fa9e013186fc5455a0b29" title="ocif_" alt="" coords="507,259,557,285"/>
<area shape="rect" id="node13" href="ciftbx-wrapper_8f90.html#acef84efd6e02fb3ddcab29ff8633a848" title="data_" alt="" coords="505,309,559,336"/>
<area shape="rect" id="node14" href="ciftbx-wrapper_8f90.html#a7055e00f1e5f857fc1ba8f23b19ceca2" title="char_" alt="" coords="505,360,559,387"/>
<area shape="rect" id="node15" href="readcif_8f90.html#a77bc1e77228e70be15a1fbb03b46836d" title="Procedure&#45;description: Strips any character from string which is not simply numeric or alphabetic..." alt="" coords="493,411,571,437"/>
<area shape="rect" id="node16" href="ciftbx-wrapper_8f90.html#a24b949277f1e8100bf6202c8990ef754" title="numb_" alt="" coords="501,461,563,488"/>
<area shape="rect" id="node17" href="ciftbx-wrapper_8f90.html#a5a031324d93c4e7267bf09375680dd29" title="close_" alt="" coords="502,512,562,539"/>
<area shape="rect" id="node22" href="namespacemynumbers.html#a089c488940881f62f9d4d072f83bd0f4" title="mynumbers::cross" alt="" coords="467,563,597,589"/>
<area shape="rect" id="node29" href="Ug_8f90.html#a922097e87ed8a14f8e8ccdca2071dda5" title="Procedure&#45;description: Choose scattering factors using IScatterFactorMethodFLAG. " alt="" coords="457,613,607,640"/>
<area shape="rect" id="node30" href="Ug_8f90.html#abaeadfb0b984da3e9c7635c9fdef9e8c" title="Procedure&#45;description: Returns a PseudoAtom scattering factor. " alt="" coords="1050,728,1143,755"/>
<area shape="rect" id="node31" href="refineutils_8f90.html#ad2c03a77514775092e8856015a2e82d6" title="Procedure&#45;description: " alt="" coords="494,715,570,741"/>
<area shape="rect" id="node33" href="Ug_8f90.html#a72eb459681c0220af8f3fbd3d64bb510" title="Procedure&#45;description: " alt="" coords="1041,841,1152,868"/>
<area shape="rect" id="node35" href="symmetry_8f90.html#a304fb0bf7588e5d15981b34b36eef7fb" title="Procedure&#45;description: Convert SSpacegrp to lower case and Compare SSpaceGrpNoSpaces with every space..." alt="" coords="439,993,625,1020"/>
<area shape="rect" id="node36" href="symmetry_8f90.html#af2255ae3d44da8d3c6db18fac79a7e8c" title="Procedure&#45;description: " alt="" coords="449,892,615,919"/>
<area shape="rect" id="node37" href="symmetry_8f90.html#a65a8fff419263fc7543d69199d625da9" title="Procedure&#45;description: " alt="" coords="437,943,627,969"/>
<area shape="rect" id="node40" href="image_8f90.html#a29d13685c06d4aea49dfdbf025196f4f" title="Procedure&#45;description: Sets the positions of the centres of the disks and calculate the size of the f..." alt="" coords="469,1044,595,1071"/>
<area shape="rect" id="node41" href="image_8f90.html#a2e93570806fa274cf5db8174f071782e" title="Procedure&#45;description: Creates a circular or square image mask depending on the value of IMaskFLAG an..." alt="" coords="453,1095,611,1121"/>
<area shape="rect" id="node43" href="bloch_8f90.html#a1702defd0ca12a6793b44c37899a4683" title="Procedure&#45;description: Simulates the electron beam and calculates Bloch coefficients, conisdering complex amplitudes and iterating over the thickness. " alt="" coords="1009,1145,1184,1172"/>
<area shape="rect" id="node44" href="felixfunction_8f90.html#a37ef4d9b2ef4eaacbd5fc82ebb8843d9" title="Procedure&#45;description: Performs a 2D Gaussian blur on the input image using global variable RBlurRadi..." alt="" coords="1071,1196,1122,1223"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8885a59d6f16b8d1febf5f7322f052fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine outofunitcellcheck </td>
          <td>(</td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IVariableID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(rkind), intent(in)&#160;</td>
          <td class="paramname"><em>RProposedMovement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(rkind), intent(out)&#160;</td>
          <td class="paramname"><em>RCorrectedMovement</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Procedure-description: Checks that vector movement applied by the simplex initialisation does not move an atom out fo the unit cell, and if it does the atom is moved back into the unit cell on the opposite side as if the atom had moved from one unit cell into the neighbouring one. </p>
<p>Major-Authors: Keith Evans (2014), Richard Beanland (2016) </p>

</div>
</div>
<a class="anchor" id="ae1958943a62f02d0f6aa287fedf1f204"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(rkind) function randomnumber </td>
          <td>(</td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IRequestedNumber</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IErr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Procedure-description: Sets up a pseudo random sequence and selects a number. </p>
<p>Major-Authors: Keith Evans (2014), Richard Beanland (2016) </p>

</div>
</div>
<a class="anchor" id="a4efcf826a274c8692db15b4011b7a1a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine setupatomicvectormovements </td>
          <td>(</td>
          <td class="paramtype">integer(ikind)&#160;</td>
          <td class="paramname"><em>IErr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Procedure-description: Setup atomic vector movements. </p>
<p>Major-Authors: Richard Beanland (2016) </p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="felixrefine_8f90_a4efcf826a274c8692db15b4011b7a1a1_cgraph.png" border="0" usemap="#felixrefine_8f90_a4efcf826a274c8692db15b4011b7a1a1_cgraph" alt=""/></div>
<map name="felixrefine_8f90_a4efcf826a274c8692db15b4011b7a1a1_cgraph" id="felixrefine_8f90_a4efcf826a274c8692db15b4011b7a1a1_cgraph">
<area shape="rect" id="node2" href="symmetry_8f90.html#a304fb0bf7588e5d15981b34b36eef7fb" title="Procedure&#45;description: Convert SSpacegrp to lower case and Compare SSpaceGrpNoSpaces with every space..." alt="" coords="253,5,439,32"/>
<area shape="rect" id="node4" href="symmetry_8f90.html#af2255ae3d44da8d3c6db18fac79a7e8c" title="Procedure&#45;description: " alt="" coords="263,56,429,83"/>
<area shape="rect" id="node5" href="symmetry_8f90.html#a65a8fff419263fc7543d69199d625da9" title="Procedure&#45;description: " alt="" coords="251,107,441,133"/>
<area shape="rect" id="node3" href="symmetry_8f90.html#a8bfd2b67d8e92828d693a884ba9890ea" title="Procedure&#45;description: " alt="" coords="489,5,575,32"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="felixrefine_8f90.html">felixrefine.f90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
